{"fileType":"apogee app js workspace","version":"0.60","references":{"refEntries":[{"entryType":"npm module","url":"apogeejs-module-sqlite","nickname":"apogeejs-module-sqlite","serverUrl":""}],"viewState":{"treeState":1,"lists":{"npm module":{"treeState":1}}}},"code":{"model":{"fileType":"apogee model","version":0.3,"name":"Apogee Module Repository","children":{"main":{"name":"main","type":"apogee.Folder","children":{"addUser":{"name":"addUser","type":"apogee.Folder","children":{"inputForm":{"name":"inputForm","type":"apogee.Folder","children":{"formData":{"name":"formData","type":"apogee.JsonMember","updateData":{"data":{"uniqueKey":"topLevelDataPanel","type":"panel","formData":[{"key":"basicTextField","value":{"uniqueKey":"basicTextField","type":"textField","label":"User Name: ","customLayout":{"size":"50"},"value":"","expressionType":"value","hint":"","help":"","useSelector":"none","key":"userName"}},{"key":"basicTextField","value":{"uniqueKey":"basicTextField","type":"textField","label":"Email: ","customLayout":{"size":"50"},"value":"","expressionType":"value","hint":"","help":"","useSelector":"none","key":"email"}},{"key":"basicTextField","value":{"uniqueKey":"basicTextField","type":"textField","label":"Password: ","customLayout":{"size":"50"},"value":"","expressionType":"value","hint":"","help":"","useSelector":"none","key":"password"}}],"submit":{"type":"submit","useSubmit":true,"submitLabel":"OK","useCancel":true,"cancelLabel":"Clear Request"}}}},"formResult":{"name":"formResult","type":"apogee.JsonMember","updateData":{"data":{"uniqueKey":"topLevelDataPanel","type":"panel","formData":[{"key":"basicTextField","value":{"uniqueKey":"basicTextField","type":"textField","label":"User Name: ","customLayout":{"size":"50"},"value":"","expressionType":"value","hint":"","help":"","useSelector":"none","key":"userName"}},{"key":"basicTextField","value":{"uniqueKey":"basicTextField","type":"textField","label":"Email: ","customLayout":{"size":"50"},"value":"","expressionType":"value","hint":"","help":"","useSelector":"none","key":"email"}},{"key":"basicTextField","value":{"uniqueKey":"basicTextField","type":"textField","label":"Password: ","customLayout":{"size":"50"},"value":"","expressionType":"value","hint":"","help":"","useSelector":"none","key":"password"}}],"submit":{"type":"submit","useSubmit":true,"submitLabel":"OK","useCancel":true,"cancelLabel":"Clear Request"}},"contextParentGeneration":2}},"data":{"name":"data","type":"apogee.DesignerActionFormMember"}},"childrenNotWriteable":true},"requestBody":{"name":"requestBody","type":"apogee.JsonMember","updateData":{"invalidValue":true}},"inputValid":{"name":"inputValid","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"return true;","supplementalCode":""}},"passwordHash":{"name":"passwordHash","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"return  main.auth.getEncryptedPasswordPromise(requestBody.password);","supplementalCode":""}},"insertUserQuery":{"name":"insertUserQuery","type":"apogee.Folder","children":{"formData":{"name":"formData","type":"apogee.JsonMember","updateData":{"data":{"dbPath":"main.dbFileForm.value","pathType":"simple","queryType":"run","sql":"INSERT INTO user (user_name,email,password_hash) VALUES (?,?,?)","sqlType":"value","params":"params","parameterType":"simple","cached":false,"openType":"readwrite","verbose":true,"createIfMissing":false,"resultDialog":false}}},"formResult":{"name":"formResult","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"let output = {};\noutput[\"dbPath\"] = main.dbFileForm.value\noutput[\"pathType\"] = \"simple\"\noutput[\"queryType\"] = \"run\"\noutput[\"sql\"] = \"INSERT INTO user (user_name,email,password_hash) VALUES (?,?,?)\"\noutput[\"sqlType\"] = \"value\"\noutput[\"params\"] = params\noutput[\"parameterType\"] = \"simple\"\noutput[\"cached\"] = false\noutput[\"openType\"] = \"readwrite\"\noutput[\"verbose\"] = true\noutput[\"createIfMissing\"] = false\noutput[\"resultDialog\"] = false\nreturn output;","supplementalCode":"","contextParentGeneration":2}},"data":{"name":"data","type":"apogee.SqliteQueryMember"}},"childrenNotWriteable":true},"params":{"name":"params","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"return [\n  requestBody.userName,\n  requestBody.email,\n  passwordHash\n];","supplementalCode":""}},"_endpointDescriptor_addUser":{"name":"_endpointDescriptor_addUser","type":"apogee.JsonMember","updateData":{"data":{"name":"Add User","path":"/user/add","method":"post","inputs":{"body":"main.requestBody"}}}}}},"auth":{"name":"auth","type":"apogee.Folder","children":{"getEncryptedPasswordPromise":{"name":"getEncryptedPasswordPromise","type":"apogee.FunctionMember","updateData":{"argList":["rawPassword"],"functionBody":"if(rawPassword) {\n    let bcrypt = require(\"bcrypt\");\n    let encryptedPromise = new Promise( (resolve,reject) => {\n            bcrypt.hash(rawPassword, SALT_ROUNDS, function(err, hash) {\n                if(err) {\n                    reject(err);\n                }\n                else {\n                    resolve(hash);\n                }\n        });\n    })\n    return encryptedPromise;\n}\nelse {\n    return apogeeutil.INVALID_VALUE;\n}","supplementalCode":""}},"isMatchPromise":{"name":"isMatchPromise","type":"apogee.FunctionMember","updateData":{"argList":["rawPassword","passKey"],"functionBody":"if((rawPassword)&&(passKey)) {\n    let bcrypt = require(\"bcrypt\");\n    let matchPromise = new Promise( (resolve,reject) => {\n        bcrypt.compare(rawPassword, passKey, function(err, result) {\n            if(err) {\n                reject(err);\n            }\n            else {\n                resolve(result);\n            }\n        });\n    })\n    return matchPromise;\n}\nelse {\n    return apogeeutil.INVALID_VALUE;\n}","supplementalCode":""}},"SALT_ROUNDS":{"name":"SALT_ROUNDS","type":"apogee.JsonMember","updateData":{"data":10}}}},"dbFileForm":{"name":"dbFileForm","type":"apogee.Folder","children":{"input":{"name":"input","type":"apogee.JsonMember","updateData":{"data":""}},"value":{"name":"value","type":"apogee.JsonMember","updateData":{"data":"C:\\Dave\\dev\\github\\apogeejs-module-repository\\database\\ModuleRepo.db"}}},"childrenNotWriteable":true},"addModule":{"name":"addModule","type":"apogee.Folder","children":{"requestBody":{"name":"requestBody","type":"apogee.JsonMember","updateData":{"invalidValue":true}},"inputValid":{"name":"inputValid","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"return true;","supplementalCode":""}},"inputForm":{"name":"inputForm","type":"apogee.Folder","children":{"formData":{"name":"formData","type":"apogee.JsonMember","updateData":{"data":{"uniqueKey":"topLevelDataPanel","type":"panel","formData":[{"key":"basicTextField","value":{"uniqueKey":"basicTextField","type":"textField","label":"Module Name: ","customLayout":{"size":"50"},"value":"","expressionType":"value","hint":"","help":"","useSelector":"none","key":"moduleName"}},{"key":"basicTextField","value":{"uniqueKey":"basicTextField","type":"textField","label":"User Name:","customLayout":{"size":"50"},"value":"","expressionType":"value","hint":"","help":"","useSelector":"none","key":"userName"}},{"key":"basicTextField","value":{"uniqueKey":"basicTextField","type":"textField","label":"Display Name:","customLayout":{"size":"50"},"value":"","expressionType":"value","hint":"","help":"","useSelector":"none","key":"displayName"}},{"key":"basicTextarea","value":{"uniqueKey":"basicTextarea","type":"textarea","label":"Short Description:","customLayout":{"cols":"50","rows":"4"},"value":"","expressionType":"value","hint":"","help":"","useSelector":"none","key":"shortDesc"}}],"submit":{"type":"submit","useSubmit":true,"submitLabel":"OK","useCancel":true,"cancelLabel":"Clear Request"}}}},"formResult":{"name":"formResult","type":"apogee.JsonMember","updateData":{"data":{"uniqueKey":"topLevelDataPanel","type":"panel","formData":[{"key":"basicTextField","value":{"uniqueKey":"basicTextField","type":"textField","label":"Module Name: ","customLayout":{"size":"50"},"value":"","expressionType":"value","hint":"","help":"","useSelector":"none","key":"moduleName"}},{"key":"basicTextField","value":{"uniqueKey":"basicTextField","type":"textField","label":"User Name:","customLayout":{"size":"50"},"value":"","expressionType":"value","hint":"","help":"","useSelector":"none","key":"userName"}},{"key":"basicTextField","value":{"uniqueKey":"basicTextField","type":"textField","label":"Display Name:","customLayout":{"size":"50"},"value":"","expressionType":"value","hint":"","help":"","useSelector":"none","key":"displayName"}},{"key":"basicTextarea","value":{"uniqueKey":"basicTextarea","type":"textarea","label":"Short Description:","customLayout":{"cols":"50","rows":"4"},"value":"","expressionType":"value","hint":"","help":"","useSelector":"none","key":"shortDesc"}}],"submit":{"type":"submit","useSubmit":true,"submitLabel":"OK","useCancel":true,"cancelLabel":"Clear Request"}},"contextParentGeneration":2}},"data":{"name":"data","type":"apogee.DesignerActionFormMember"}},"childrenNotWriteable":true},"params":{"name":"params","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"return [\n  requestBody.moduleName,\n  requestBody.userName,\n  requestBody.displayName,\n  requestBody.shortDesc\n];","supplementalCode":""}},"insertUserQuery":{"name":"insertUserQuery","type":"apogee.Folder","children":{"formData":{"name":"formData","type":"apogee.JsonMember","updateData":{"data":{"dbPath":"main.dbFileForm.value","pathType":"simple","queryType":"run","sql":"INSERT INTO module (module_name,user_name,display_name,short_description) VALUES (?,?,?,?)","sqlType":"value","params":"params","parameterType":"simple","cached":false,"openType":"readwrite","verbose":true,"createIfMissing":false,"resultDialog":false}}},"formResult":{"name":"formResult","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"let output = {};\noutput[\"dbPath\"] = main.dbFileForm.value\noutput[\"pathType\"] = \"simple\"\noutput[\"queryType\"] = \"run\"\noutput[\"sql\"] = \"INSERT INTO module (module_name,user_name,display_name,short_description) VALUES (?,?,?,?)\"\noutput[\"sqlType\"] = \"value\"\noutput[\"params\"] = params\noutput[\"parameterType\"] = \"simple\"\noutput[\"cached\"] = false\noutput[\"openType\"] = \"readwrite\"\noutput[\"verbose\"] = true\noutput[\"createIfMissing\"] = false\noutput[\"resultDialog\"] = false\nreturn output;","supplementalCode":"","contextParentGeneration":2}},"data":{"name":"data","type":"apogee.SqliteQueryMember"}},"childrenNotWriteable":true},"_endpointDescriptor_addModule":{"name":"_endpointDescriptor_addModule","type":"apogee.JsonMember","updateData":{"data":{"name":"Add Module","path":"/module/add","method":"post","inputs":{"body":"main.requestBody"}}}}}},"addModuleVersion":{"name":"addModuleVersion","type":"apogee.Folder","children":{"inputForm":{"name":"inputForm","type":"apogee.Folder","children":{"formData":{"name":"formData","type":"apogee.JsonMember","updateData":{"data":{"uniqueKey":"topLevelDataPanel","type":"panel","formData":[{"key":"basicTextField","value":{"uniqueKey":"basicTextField","type":"textField","label":"Module Name: ","customLayout":{"size":"50"},"value":"","expressionType":"value","hint":"","help":"","useSelector":"none","key":"moduleName"}},{"key":"basicTextField","value":{"uniqueKey":"basicTextField","type":"textField","label":"Module Version: ","customLayout":{"size":"25"},"value":"","expressionType":"value","hint":"","help":"","useSelector":"none","key":"moduleVersion"}},{"key":"basicTextField","value":{"uniqueKey":"basicTextField","type":"textField","label":"NPM Name: ","customLayout":{"size":"50"},"value":"","expressionType":"value","hint":"","help":"","useSelector":"none","key":"npmName"}},{"key":"simpleList","value":{"uniqueKey":"simpleList","type":"list","label":"ES Workspace URLs:","entryType":{"label":"ES Workspace","key":"basicTextField","value":{"uniqueKey":"basicTextField","type":"textField","label":"","customLayout":{"size":"100"},"value":"","expressionType":"value","hint":"","help":"","useSelector":"none","key":"url"}},"hint":"","help":"","useSelector":"none","key":"esWorkspaceUrls"}},{"key":"simpleList","value":{"uniqueKey":"simpleList","type":"list","label":"NPM Workspace URLs:","entryType":{"label":"NPM Workspace","key":"basicTextField","value":{"uniqueKey":"basicTextField","type":"textField","label":"","customLayout":{"size":"100"},"value":"","expressionType":"value","hint":"","help":"","useSelector":"none","key":"url"}},"hint":"","help":"","useSelector":"none","key":"npmWorkspaceUrls"}},{"key":"basicTextField","value":{"uniqueKey":"basicTextField","type":"textField","label":"Web Link: ","customLayout":{"size":"100"},"value":"","expressionType":"value","hint":"","help":"","useSelector":"none","key":"webLink"}}],"submit":{"type":"submit","useSubmit":true,"submitLabel":"OK","useCancel":true,"cancelLabel":"Clear Request"}}}},"formResult":{"name":"formResult","type":"apogee.JsonMember","updateData":{"data":{"uniqueKey":"topLevelDataPanel","type":"panel","formData":[{"key":"basicTextField","value":{"uniqueKey":"basicTextField","type":"textField","label":"Module Name: ","customLayout":{"size":"50"},"value":"","expressionType":"value","hint":"","help":"","useSelector":"none","key":"moduleName"}},{"key":"basicTextField","value":{"uniqueKey":"basicTextField","type":"textField","label":"Module Version: ","customLayout":{"size":"25"},"value":"","expressionType":"value","hint":"","help":"","useSelector":"none","key":"moduleVersion"}},{"key":"basicTextField","value":{"uniqueKey":"basicTextField","type":"textField","label":"NPM Name: ","customLayout":{"size":"50"},"value":"","expressionType":"value","hint":"","help":"","useSelector":"none","key":"npmName"}},{"key":"simpleList","value":{"uniqueKey":"simpleList","type":"list","label":"ES Workspace URLs:","entryType":{"label":"ES Workspace","key":"basicTextField","value":{"uniqueKey":"basicTextField","type":"textField","label":"","customLayout":{"size":"100"},"value":"","expressionType":"value","hint":"","help":"","useSelector":"none","key":"url"}},"hint":"","help":"","useSelector":"none","key":"esWorkspaceUrls"}},{"key":"simpleList","value":{"uniqueKey":"simpleList","type":"list","label":"NPM Workspace URLs:","entryType":{"label":"NPM Workspace","key":"basicTextField","value":{"uniqueKey":"basicTextField","type":"textField","label":"","customLayout":{"size":"100"},"value":"","expressionType":"value","hint":"","help":"","useSelector":"none","key":"url"}},"hint":"","help":"","useSelector":"none","key":"npmWorkspaceUrls"}},{"key":"basicTextField","value":{"uniqueKey":"basicTextField","type":"textField","label":"Web Link: ","customLayout":{"size":"100"},"value":"","expressionType":"value","hint":"","help":"","useSelector":"none","key":"webLink"}}],"submit":{"type":"submit","useSubmit":true,"submitLabel":"OK","useCancel":true,"cancelLabel":"Clear Request"}},"contextParentGeneration":2}},"data":{"name":"data","type":"apogee.DesignerActionFormMember"}},"childrenNotWriteable":true},"requestBody":{"name":"requestBody","type":"apogee.JsonMember","updateData":{"invalidValue":true}},"inputValid":{"name":"inputValid","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"return true;","supplementalCode":""}},"params":{"name":"params","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"//load the optional values\n\nlet npmName = (requestBody.npmName) ? requestBody.npmName : null;\nlet esWorkspaceUrlsText = ((requestBody.esWorkspaceUrls)&&(requestBody.esWorkspaceUrls.length > 0)) ? JSON.stringify(requestBody.esWorkspaceUrls) : null; \nlet npmWorkspaceUrlsText = ((requestBody.npmWorkspaceUrls)&&(requestBody.npmWorkspaceUrls.length > 0)) ? JSON.stringify(requestBody.npmWorkspaceUrls) : null; \nlet webLink = (requestBody.webLink) ? requestBody.webLink : null;\n\nreturn [\n  requestBody.moduleName,\n  requestBody.moduleVersion,\n  npmName,\n  esWorkspaceUrlsText,\n  npmWorkspaceUrlsText,\n  webLink\n];","supplementalCode":""}},"insertModuleVersionQuery":{"name":"insertModuleVersionQuery","type":"apogee.Folder","children":{"formData":{"name":"formData","type":"apogee.JsonMember","updateData":{"data":{"dbPath":"main.dbFileForm.value","pathType":"simple","queryType":"run","sql":"INSERT INTO module_version (module_name, module_version, npm_name, es_workspaces, npm_workspaces, web_link) VALUES (?,?,?,?,?,?)","sqlType":"value","params":"params","parameterType":"simple","cached":false,"openType":"readwrite","verbose":true,"createIfMissing":false,"resultDialog":false}}},"formResult":{"name":"formResult","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"let output = {};\noutput[\"dbPath\"] = main.dbFileForm.value\noutput[\"pathType\"] = \"simple\"\noutput[\"queryType\"] = \"run\"\noutput[\"sql\"] = \"INSERT INTO module_version (module_name, module_version, npm_name, es_workspaces, npm_workspaces, web_link) VALUES (?,?,?,?,?,?)\"\noutput[\"sqlType\"] = \"value\"\noutput[\"params\"] = params\noutput[\"parameterType\"] = \"simple\"\noutput[\"cached\"] = false\noutput[\"openType\"] = \"readwrite\"\noutput[\"verbose\"] = true\noutput[\"createIfMissing\"] = false\noutput[\"resultDialog\"] = false\nreturn output;","supplementalCode":"","contextParentGeneration":2}},"data":{"name":"data","type":"apogee.SqliteQueryMember"}},"childrenNotWriteable":true},"_endpointDescriptor_addModuleVersion":{"name":"_endpointDescriptor_addModuleVersion","type":"apogee.JsonMember","updateData":{"data":{"name":"Add Module","path":"/module/addversion","method":"post","inputs":{"body":"main.requestBody"}}}}}},"getModules":{"name":"getModules","type":"apogee.Folder","children":{"inputForm":{"name":"inputForm","type":"apogee.Folder","children":{"formData":{"name":"formData","type":"apogee.JsonMember","updateData":{"data":{"uniqueKey":"topLevelDataPanel","type":"panel","formData":[{"key":"basicRadioGroup","value":{"uniqueKey":"basicRadioGroup","type":"radioButtonGroup","label":"Module Type: ","entriesList":[{"valueMixed":"es","valueType":"string","displayLabel":"ES Module"},{"valueMixed":"npm","valueType":"string","displayLabel":"NPM Module"}],"entriesType":"value","customLayout":{"vertical":false},"valueMixed":"es","valueType":"string","hint":"","help":"","useSelector":"none","key":"moduleType"}}],"submit":{"type":"submit","useSubmit":true,"submitLabel":"OK","useCancel":true,"cancelLabel":"Clear Request"}}}},"formResult":{"name":"formResult","type":"apogee.JsonMember","updateData":{"data":{"uniqueKey":"topLevelDataPanel","type":"panel","formData":[{"key":"basicRadioGroup","value":{"uniqueKey":"basicRadioGroup","type":"radioButtonGroup","label":"Module Type: ","entriesList":[{"valueMixed":"es","valueType":"string","displayLabel":"ES Module"},{"valueMixed":"npm","valueType":"string","displayLabel":"NPM Module"}],"entriesType":"value","customLayout":{"vertical":false},"valueMixed":"es","valueType":"string","hint":"","help":"","useSelector":"none","key":"moduleType"}}],"submit":{"type":"submit","useSubmit":true,"submitLabel":"OK","useCancel":true,"cancelLabel":"Clear Request"}},"contextParentGeneration":2}},"data":{"name":"data","type":"apogee.DesignerActionFormMember"}},"childrenNotWriteable":true},"inputValid":{"name":"inputValid","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"return true;","supplementalCode":""}},"requestParams":{"name":"requestParams","type":"apogee.JsonMember","updateData":{"invalidValue":true}},"responseBody":{"name":"responseBody","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"return moduleData;","supplementalCode":""}},"sql":{"name":"sql","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"if(requestParams.moduleType == \"es\") {\n    return ES_SQL;\n}\nelse if(requestParams.moduleType == \"npm\") {\n    return NPM_SQL;\n}\nelse {\n    throw new Error(\"Invalid module type: \" + requestParams.moduleType);\n}","supplementalCode":""}},"NPM_SQL":{"name":"NPM_SQL","type":"apogee.JsonMember","updateData":{"data":"SELECT * FROM module_version \nJOIN module ON (module_version.module_name = module.module_name)\nWHERE module_version.npm_url IS NOT NULL OR module_version.npm_name IS NOT NULL"}},"ES_SQL":{"name":"ES_SQL","type":"apogee.JsonMember","updateData":{"data":"SELECT * FROM module_version \nINNER JOIN module ON (module_version.module_name = module.module_name) \nWHERE module_version.es_url IS NOT NULL"}},"getModulesQuery":{"name":"getModulesQuery","type":"apogee.Folder","children":{"formData":{"name":"formData","type":"apogee.JsonMember","updateData":{"data":{"dbPath":"main.dbFileForm.value","pathType":"simple","queryType":"all","sql":"sql","sqlType":"simple","params":"","parameterType":"simple","cached":false,"openType":"readwrite","verbose":true,"createIfMissing":false,"resultDialog":false}}},"formResult":{"name":"formResult","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"let output = {};\noutput[\"dbPath\"] = main.dbFileForm.value\noutput[\"pathType\"] = \"simple\"\noutput[\"queryType\"] = \"all\"\noutput[\"sql\"] = sql\noutput[\"sqlType\"] = \"simple\"\noutput[\"parameterType\"] = \"simple\"\noutput[\"cached\"] = false\noutput[\"openType\"] = \"readwrite\"\noutput[\"verbose\"] = true\noutput[\"createIfMissing\"] = false\noutput[\"resultDialog\"] = false\nreturn output;","supplementalCode":"","contextParentGeneration":2}},"data":{"name":"data","type":"apogee.SqliteQueryMember"}},"childrenNotWriteable":true},"moduleMap":{"name":"moduleMap","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"let moduleMap = {};\ngetModulesQuery.data.forEach(moduleInfo => {\n    let moduleEntry = moduleMap[moduleInfo.module_name];\n    if(!moduleEntry) {\n        moduleEntry = {};\n        moduleEntry.moduleName = moduleInfo.module_name;\n        moduleEntry.displayName = moduleInfo.display_name;\n        moduleEntry.shortDesc = moduleInfo.short_description;\n        moduleEntry.versions = [];\n        moduleMap[moduleInfo.module_name] = moduleEntry;\n    }\n    \n    versionEntry = {};\n    versionEntry.version = moduleInfo.module_version;\n    if(requestParams.moduleType == \"es\") {\n        if(moduleInfo.es_url) versionEntry.esUrl = moduleInfo.es_url;\n        if(moduleInfo.es_workspaces) {\n            try {\n                let esWorkspaces = JSON.parse(moduleInfo.es_workspaces);\n                versionEntry.esDemoWorkspaces = esWorkspaces;\n            }\n            catch(error) {\n                //uh, throw this in...\n                versionEntry.esDemoWorkspacesError = error.toString();\n            }\n        }\n    }\n    else if(requestParams.moduleType == \"npm\") {\n        if(moduleInfo.npm_url) versionEntry.esUrl = moduleInfo.npm_url;\n        if(moduleInfo.npm_workspaces) {\n            try {\n                let npmWorkspaces = JSON.parse(moduleInfo.npm_workspaces);\n                versionEntry.npmDemoWorkspaces = npmWorkspaces;\n            }\n            catch(error) {\n                //uh, throw this in...\n                versionEntry.npmDemoWorkspacesError = error.toString();\n            }\n        }\n    }\n    else {\n        throw new Error(\"Unrocognized module type: \" + requestParams.moduleType);\n    }\n    if(moduleInfo.web_link) versionEntry.webLink = moduleInfo.web_link;\n    \n    moduleEntry.versions.push(versionEntry);\n})\nreturn moduleMap;","supplementalCode":""}},"moduleData":{"name":"moduleData","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"let data = {};\ndata.version = \"0.0\",\ndata.fileType = \"moduleData\";\ndata.modules = [];\n\nfor(let moduleName in moduleMap) {\n    let moduleEntry = moduleMap[moduleName];\n    data.modules.push(moduleEntry);\n}\n\n\n\nreturn data;","supplementalCode":""}},"_endpointDescriptor_addModuleVersion":{"name":"_endpointDescriptor_addModuleVersion","type":"apogee.JsonMember","updateData":{"data":{"name":"Get Modules","path":"/modules","method":"get","inputs":{"qureyParams":"main.requestParams"}}}}}},"uploadModuleFile":{"name":"uploadModuleFile","type":"apogee.Folder","children":{"inputForm":{"name":"inputForm","type":"apogee.Folder","children":{"formData":{"name":"formData","type":"apogee.JsonMember","updateData":{"data":{"uniqueKey":"topLevelDataPanel","type":"panel","formData":[{"key":"basicTextField","value":{"uniqueKey":"basicTextField","type":"textField","label":"Module Name: ","customLayout":{"size":"50"},"value":"","expressionType":"value","hint":"","help":"","useSelector":"none","key":"moduleName"}},{"key":"basicTextField","value":{"uniqueKey":"basicTextField","type":"textField","label":"Module Version: ","customLayout":{"size":"25"},"value":"","expressionType":"value","hint":"","help":"","useSelector":"none","key":"moduleVersion"}},{"key":"basicRadioGroup","value":{"uniqueKey":"basicRadioGroup","type":"radioButtonGroup","label":"Module Type:","entriesList":[{"valueMixed":"es","valueType":"string","displayLabel":"ES Module"},{"valueMixed":"npm","valueType":"string","displayLabel":"NPM Module"}],"entriesType":"value","customLayout":{"vertical":false},"valueMixed":"es","valueType":"string","hint":"","help":"","useSelector":"none","key":"moduleType"}},{"key":"basicTextField","value":{"uniqueKey":"basicTextField","type":"textField","label":"File Name: ","customLayout":{"size":"50"},"value":"","expressionType":"value","hint":"","help":"","useSelector":"none","key":"fileName"}},{"key":"basicTextarea","value":{"uniqueKey":"basicTextarea","type":"textarea","label":"Module File: ","customLayout":{"cols":"100","rows":"10"},"value":"","expressionType":"value","hint":"","help":"","useSelector":"none","key":"file"}}],"submit":{"type":"submit","useSubmit":true,"submitLabel":"OK","useCancel":true,"cancelLabel":"Clear Request"}}}},"formResult":{"name":"formResult","type":"apogee.JsonMember","updateData":{"data":{"uniqueKey":"topLevelDataPanel","type":"panel","formData":[{"key":"basicTextField","value":{"uniqueKey":"basicTextField","type":"textField","label":"Module Name: ","customLayout":{"size":"50"},"value":"","expressionType":"value","hint":"","help":"","useSelector":"none","key":"moduleName"}},{"key":"basicTextField","value":{"uniqueKey":"basicTextField","type":"textField","label":"Module Version: ","customLayout":{"size":"25"},"value":"","expressionType":"value","hint":"","help":"","useSelector":"none","key":"moduleVersion"}},{"key":"basicRadioGroup","value":{"uniqueKey":"basicRadioGroup","type":"radioButtonGroup","label":"Module Type:","entriesList":[{"valueMixed":"es","valueType":"string","displayLabel":"ES Module"},{"valueMixed":"npm","valueType":"string","displayLabel":"NPM Module"}],"entriesType":"value","customLayout":{"vertical":false},"valueMixed":"es","valueType":"string","hint":"","help":"","useSelector":"none","key":"moduleType"}},{"key":"basicTextField","value":{"uniqueKey":"basicTextField","type":"textField","label":"File Name: ","customLayout":{"size":"50"},"value":"","expressionType":"value","hint":"","help":"","useSelector":"none","key":"fileName"}},{"key":"basicTextarea","value":{"uniqueKey":"basicTextarea","type":"textarea","label":"Module File: ","customLayout":{"cols":"100","rows":"10"},"value":"","expressionType":"value","hint":"","help":"","useSelector":"none","key":"file"}}],"submit":{"type":"submit","useSubmit":true,"submitLabel":"OK","useCancel":true,"cancelLabel":"Clear Request"}},"contextParentGeneration":2}},"data":{"name":"data","type":"apogee.DesignerActionFormMember"}},"childrenNotWriteable":true},"requestBody":{"name":"requestBody","type":"apogee.JsonMember","updateData":{"invalidValue":true}},"inputValid":{"name":"inputValid","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"//verify module types\nconst MODULE_TYPES = [\"es\",\"npm\"];\nif(MODULE_TYPES.indexOf(pathParams.moduleType) < 0) throw new Error(\"Unknonw module type: \" + pathParams.moduleType);\n\n//verify file name for url\nlet properFileName = `${pathParams.moduleName}.${pathParams.moduleType}.js`;\nif(pathParams.fileName != properFileName) throw new Error(`File name does not match expected value: received = ${pathParams.fileName}, expected = ${properFileName}`);\n\nreturn true;","supplementalCode":""}},"saveFile":{"name":"saveFile","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"//this is added just so we save after the query succeeds\r\nlet insertResult = updateModuleVersionQuery.data;\r\n\r\n//write the file\r\nconst {writeFile,mkdir} = require('fs/promises');\r\nconst path = require('path');\r\n//first check if we need to make the directory\r\nlet parentDir = path.dirname(fullFilePath);\r\nreturn mkdir(parentDir,{recursive: true}).then(() => writeFile(fullFilePath,requestBody));","supplementalCode":""}},"loadModuleQuery":{"name":"loadModuleQuery","type":"apogee.Folder","children":{"formData":{"name":"formData","type":"apogee.JsonMember","updateData":{"data":{"dbPath":"main.dbFileForm.value","pathType":"simple","queryType":"get","sql":"select * from module inner join module_version \non module.module_name = module_version.module_name\nwhere module.module_name = ? and module_version.module_version = ?","sqlType":"value","params":"loadQueryParams","parameterType":"simple","cached":false,"openType":"readwrite","verbose":true,"createIfMissing":false,"resultDialog":false}}},"formResult":{"name":"formResult","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"let output = {};\noutput[\"dbPath\"] = main.dbFileForm.value\noutput[\"pathType\"] = \"simple\"\noutput[\"queryType\"] = \"get\"\noutput[\"sql\"] = \"select * from module inner join module_version \\non module.module_name = module_version.module_name\\nwhere module.module_name = ? and module_version.module_version = ?\"\noutput[\"sqlType\"] = \"value\"\noutput[\"params\"] = loadQueryParams\noutput[\"parameterType\"] = \"simple\"\noutput[\"cached\"] = false\noutput[\"openType\"] = \"readwrite\"\noutput[\"verbose\"] = true\noutput[\"createIfMissing\"] = false\noutput[\"resultDialog\"] = false\nreturn output;","supplementalCode":"","contextParentGeneration":2}},"data":{"name":"data","type":"apogee.SqliteQueryMember"}},"childrenNotWriteable":true},"updateModuleVersionQuery":{"name":"updateModuleVersionQuery","type":"apogee.Folder","children":{"formData":{"name":"formData","type":"apogee.JsonMember","updateData":{"data":{"dbPath":"main.dbFileForm.value","pathType":"simple","queryType":"run","sql":"updateQuerySql","sqlType":"simple","params":"updateQueryParams","parameterType":"simple","cached":false,"openType":"readwrite","verbose":true,"createIfMissing":false,"resultDialog":false}}},"formResult":{"name":"formResult","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"let output = {};\noutput[\"dbPath\"] = main.dbFileForm.value\noutput[\"pathType\"] = \"simple\"\noutput[\"queryType\"] = \"run\"\noutput[\"sql\"] = updateQuerySql\noutput[\"sqlType\"] = \"simple\"\noutput[\"params\"] = updateQueryParams\noutput[\"parameterType\"] = \"simple\"\noutput[\"cached\"] = false\noutput[\"openType\"] = \"readwrite\"\noutput[\"verbose\"] = true\noutput[\"createIfMissing\"] = false\noutput[\"resultDialog\"] = false\nreturn output;","supplementalCode":"","contextParentGeneration":2}},"data":{"name":"data","type":"apogee.SqliteQueryMember"}},"childrenNotWriteable":true},"updateQueryParams":{"name":"updateQueryParams","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"let url = main.FILE_URL_PREFIX + `/modules/${pathParams.moduleName}/${pathParams.moduleVersion}/${pathParams.moduleType}/${pathParams.moduleName}.${pathParams.moduleType}.js`\nreturn [url];","supplementalCode":""}},"pathParams":{"name":"pathParams","type":"apogee.JsonMember","updateData":{"invalidValue":true}},"loadQueryParams":{"name":"loadQueryParams","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"let ok = inputValid;\n\nreturn [pathParams.moduleName,pathParams.moduleVersion];","supplementalCode":""}},"updateQuerySql":{"name":"updateQuerySql","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"let urlField;\n\nif(pathParams.moduleType == \"es\") urlField = \"es_url\";\nelse if(pathParams.moduleType == \"npm\") urlField = \"npm_url\";\nelse throw new Error(\"Unrecognized module type: \" + pathParams.moduleType); //we don't really need this since we already vaildated the module type.\n\nreturn `UPDATE module_version set ${urlField} = ?`","supplementalCode":""}},"fullFilePath":{"name":"fullFilePath","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"const path = require(\"path\");\nreturn path.join(main.contentFolderForm.value,filePath)","supplementalCode":""}},"filePath":{"name":"filePath","type":"apogee.JsonMember","updateData":{"argList":[],"functionBody":"return `/modules/${pathParams.moduleName}/${pathParams.moduleVersion}/${pathParams.moduleType}/${pathParams.moduleName}.${pathParams.moduleType}.js`;","supplementalCode":""}},"_endpointDescriptor_uploadModuleFile":{"name":"_endpointDescriptor_uploadModuleFile","type":"apogee.JsonMember","updateData":{"data":{"name":"Upload Module File","path":"/modules/:moduleName/:moduleVersion/:format/:fileName","method":"put","inputs":{"body":"main.requestBody","pathParams":"main.pathParams"}}}}}},"FILE_URL_PREFIX":{"name":"FILE_URL_PREFIX","type":"apogee.JsonMember","updateData":{"data":"https://raw.githubusercontent.com/sutter-dave/apogeejs-module-repository/master/content/modules"}},"contentFolderForm":{"name":"contentFolderForm","type":"apogee.Folder","children":{"input":{"name":"input","type":"apogee.JsonMember","updateData":{"data":""}},"value":{"name":"value","type":"apogee.JsonMember","updateData":{"data":"C:\\Dave\\dev\\github\\apogeejs-module-repository\\content"}}},"childrenNotWriteable":true},"_serviceDescriptor_":{"name":"_serviceDescriptor_","type":"apogee.JsonMember","updateData":{"data":{"name":"Apogee Module Repository"}}}}},"Design":{"name":"Design","type":"apogee.Folder","children":{}}}},"components":{"main":{"type":"apogeeapp.PageComponent","data":{"doc":{"type":"doc","content":[{"type":"heading1","content":[{"type":"text","text":"Apogee Model Repository"}]},{"type":"heading2","content":[{"type":"text","text":"Service Descriptor"}]},{"type":"apogeeComponent","attrs":{"name":"_serviceDescriptor_","id":0,"state":""}},{"type":"heading2","content":[{"type":"text","text":"Database File"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"textcolor","attrs":{"color":"yellow"}},{"type":"highlight","attrs":{"color":"green"}}],"text":"Make a speciealized cell for this! - select a fiel (or folder)"}]},{"type":"apogeeComponent","attrs":{"name":"dbFileForm","id":0,"state":""}},{"type":"paragraph"},{"type":"apogeeComponent","attrs":{"name":"contentFolderForm","id":0,"state":""}},{"type":"paragraph"},{"type":"apogeeComponent","attrs":{"name":"FILE_URL_PREFIX","id":0,"state":""}},{"type":"paragraph"}]}},"children":{"addUser":{"type":"apogeeapp.PageComponent","data":{"doc":{"type":"doc","content":[{"type":"heading1","content":[{"type":"text","text":"Add User"}]},{"type":"heading2","content":[{"type":"text","text":"Test Input"}]},{"type":"apogeeComponent","attrs":{"name":"inputForm","id":0,"state":""}},{"type":"heading2","content":[{"type":"text","text":"Descriptor"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"textcolor","attrs":{"color":"yellow"}},{"type":"highlight","attrs":{"color":"green"}}],"text":"Make a speciealized cell for this! - endpoint and service descriptor"}]},{"type":"apogeeComponent","attrs":{"name":"_endpointDescriptor_addUser","id":0,"state":""}},{"type":"heading2","content":[{"type":"text","text":"Request"}]},{"type":"apogeeComponent","attrs":{"name":"requestBody","id":0,"state":""}},{"type":"heading2","content":[{"type":"text","text":"Response"}]},{"type":"paragraph","content":[{"type":"text","text":"No response body. An error will happen is tables have an error. "}]},{"type":"heading2","content":[{"type":"text","text":"Implementation"}]},{"type":"paragraph","content":[{"type":"text","text":"This table validates the input data. if it is not valid it throws an exception. If it is valid it just returns true."}]},{"type":"apogeeComponent","attrs":{"name":"inputValid","id":0,"state":""}},{"type":"paragraph"},{"type":"apogeeComponent","attrs":{"name":"passwordHash","id":0,"state":""}},{"type":"paragraph"},{"type":"apogeeComponent","attrs":{"name":"params","id":0,"state":""}},{"type":"paragraph"},{"type":"apogeeComponent","attrs":{"name":"insertUserQuery","id":0,"state":""}},{"type":"paragraph"},{"type":"paragraph"},{"type":"paragraph"}]}},"children":{"inputForm":{"type":"apogeeapp.DesignerActionFormCell","onSubmitCode":"cmdMsngr.dataCommand(\"requestBody\",formValue);","onCancelCode":"cmdMsngr.dataCommand(\"requestBody\",apogeeutil.INVALID_VALUE);","allowInputExpressions":true,"viewState":{"childDisplayState":{"views":{"Form":{"isViewActive":true},"Input":{"isViewActive":false},"On Save":{"height":7000,"isViewActive":false},"On Cancel":{"height":7000,"isViewActive":false}}}}},"requestBody":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":false},"Private":{"isViewActive":false}}}}},"inputValid":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":true,"height":7000},"Private":{"isViewActive":false}}}}},"passwordHash":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":false},"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":true,"height":7000},"Private":{"isViewActive":false}}}}},"insertUserQuery":{"type":"apogeeapp.SqliteQueryCell","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Result":{"height":280,"isViewActive":true},"Input":{"isViewActive":true}}}}},"params":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":true,"height":7000},"Private":{"isViewActive":false}}}}},"_endpointDescriptor_addUser":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":false},"Private":{"isViewActive":false}}}}}},"viewState":{"childDisplayState":null,"treeState":-1,"tabOpened":true}},"auth":{"type":"apogeeapp.PageComponent","data":{"doc":{"type":"doc","content":[{"type":"heading1","content":[{"type":"text","text":"Auth Utilities"}]},{"type":"apogeeComponent","attrs":{"name":"getEncryptedPasswordPromise","id":0,"state":""}},{"type":"paragraph"},{"type":"apogeeComponent","attrs":{"name":"isMatchPromise","id":0,"state":""}},{"type":"paragraph"},{"type":"apogeeComponent","attrs":{"name":"SALT_ROUNDS","id":0,"state":""}},{"type":"paragraph"},{"type":"paragraph"},{"type":"heading2"},{"type":"paragraph"}]}},"children":{"getEncryptedPasswordPromise":{"type":"apogeeapp.FunctionCell","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Code":{"isViewActive":true,"height":7000},"Private":{"isViewActive":false}}}}},"isMatchPromise":{"type":"apogeeapp.FunctionCell","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Code":{"isViewActive":true,"height":7000},"Private":{"isViewActive":false}}}}},"SALT_ROUNDS":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":false},"Private":{"isViewActive":false}}}}}},"viewState":{"childDisplayState":null,"treeState":-1,"tabOpened":true}},"dbFileForm":{"type":"apogeeapp.FullDataFormCell","layoutCode":"let onSubmit = () => {\n    var {dialog} = require('electron').remote;\n\n    let pathPromise = dialog.showOpenDialog({properties: ['openFile']})\n        .then( fileOpenResult => {\n            if(fileOpenResult.canceled) {\n                //canceled - no action\n                return;\n            }\n        \telse if(fileOpenResult.filePaths.length === 1) {\n        \t    commandMessenger.dataCommand(\"dbFileForm.value\",fileOpenResult.filePaths[0]);\n        \t}\n        \telse if(fileOpenResult.filePaths.length > 1) {\n        \t    apogeeUserAlert(\"Multiple file selection not supported!\");\n        \t}\n        \telse {\n        \t    //canceled - no action\n        \t\tapogeeUserAlert(\"Unknown error: no path selected\");\n        \t}\n        })\n        .catch(err => {\n        \tapogeeUserAlert(\"Error getting DB path: \" + err.toString());\n        });\n}\n\nreturn [\n    {\n        type: \"submit\",\n        onSubmit: onSubmit,\n        submitLabel: \"Select DB File\"\n    }    \n]","validatorCode":"return true","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"form":{"isViewActive":true},"layout":{"height":7000,"isViewActive":false},"validator":{"isViewActive":false,"height":7000},"input":{"isViewActive":false,"height":7000},"inputPrivate":{"isViewActive":false,"height":7000},"value":{"isViewActive":true,"height":280}}}}},"addModule":{"type":"apogeeapp.PageComponent","data":{"doc":{"type":"doc","content":[{"type":"heading1","content":[{"type":"text","text":"Add Module"}]},{"type":"heading2","content":[{"type":"text","text":"Test Input"}]},{"type":"apogeeComponent","attrs":{"name":"inputForm","id":0,"state":""}},{"type":"paragraph","content":[{"type":"text","text":"TO DO - get the user name from the session!"}]},{"type":"heading2","content":[{"type":"text","text":"Descriptor"}]},{"type":"apogeeComponent","attrs":{"name":"_endpointDescriptor_addModule","id":0,"state":""}},{"type":"heading2","content":[{"type":"text","text":"Request"}]},{"type":"apogeeComponent","attrs":{"name":"requestBody","id":0,"state":""}},{"type":"heading2","content":[{"type":"text","text":"Response"}]},{"type":"paragraph","content":[{"type":"text","text":"No response body. An error will happen is tables have an error. "}]},{"type":"heading2","content":[{"type":"text","text":"Implementation"}]},{"type":"paragraph","content":[{"type":"text","text":"This table validates the input data. if it is not valid it throws an exception. If it is valid it just returns true."}]},{"type":"apogeeComponent","attrs":{"name":"inputValid","id":0,"state":""}},{"type":"paragraph"},{"type":"apogeeComponent","attrs":{"name":"params","id":0,"state":""}},{"type":"paragraph"},{"type":"apogeeComponent","attrs":{"name":"insertUserQuery","id":0,"state":""}},{"type":"paragraph"},{"type":"heading2","content":[{"type":"text","text":"DOH!"}]},{"type":"paragraph","content":[{"type":"text","text":"I need to add \"try/catch/finally\". For two reasons:"}]},{"type":"bulletList","content":[{"type":"listItem","content":[{"type":"text","text":"Handling the conditional execution of the \"create module\" query. Lacking that, I will make a separate query so the user must manually create a module entry."}]},{"type":"listItem","content":[{"type":"text","text":"Cleaning up a failure in the second action - create module version entry and save file data. Lacking that I will just leave the error."}]}]}]}},"children":{"requestBody":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":false},"Private":{"isViewActive":false}}}}},"inputValid":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":true,"height":7000},"Private":{"isViewActive":false}}}}},"inputForm":{"type":"apogeeapp.DesignerActionFormCell","onSubmitCode":"cmdMsngr.dataCommand(\"requestBody\",formValue);","onCancelCode":"cmdMsngr.dataCommand(\"requestBody\",apogeeutil.INVALID_VALUE);","allowInputExpressions":true,"viewState":{"childDisplayState":{"views":{"Form":{"isViewActive":true},"Input":{"isViewActive":false},"On Save":{"height":7000,"isViewActive":false},"On Cancel":{"height":7000,"isViewActive":false}}}}},"params":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":true,"height":7000},"Private":{"isViewActive":false}}}}},"insertUserQuery":{"type":"apogeeapp.SqliteQueryCell","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Result":{"height":280,"isViewActive":true},"Input":{"isViewActive":true}}}}},"_endpointDescriptor_addModule":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":false},"Private":{"isViewActive":false}}}}}},"viewState":{"childDisplayState":null,"treeState":1,"tabOpened":true}},"addModuleVersion":{"type":"apogeeapp.PageComponent","data":{"doc":{"type":"doc","content":[{"type":"heading1","content":[{"type":"text","text":"Add Module Version"}]},{"type":"heading2","content":[{"type":"text","text":"Test Input"}]},{"type":"apogeeComponent","attrs":{"name":"inputForm","id":0,"state":""}},{"type":"paragraph","content":[{"type":"text","text":"TO DO - update submit and cancel to work with the two inputs."}]},{"type":"heading2","content":[{"type":"text","text":"Descriptor"}]},{"type":"apogeeComponent","attrs":{"name":"_endpointDescriptor_addModuleVersion","id":0,"state":""}},{"type":"heading2","content":[{"type":"text","text":"Request"}]},{"type":"apogeeComponent","attrs":{"name":"requestBody","id":0,"state":""}},{"type":"heading2","content":[{"type":"text","text":"Response"}]},{"type":"paragraph","content":[{"type":"text","text":"No response body. An error will happen is tables have an error. "}]},{"type":"heading2","content":[{"type":"text","text":"Implementation"}]},{"type":"paragraph","content":[{"type":"text","text":"This table validates the input data. if it is not valid it throws an exception. If it is valid it just returns true."}]},{"type":"apogeeComponent","attrs":{"name":"inputValid","id":0,"state":""}},{"type":"paragraph"},{"type":"apogeeComponent","attrs":{"name":"params","id":0,"state":""}},{"type":"paragraph"},{"type":"apogeeComponent","attrs":{"name":"insertModuleVersionQuery","id":0,"state":""}},{"type":"heading2"}]}},"children":{"inputForm":{"type":"apogeeapp.DesignerActionFormCell","onSubmitCode":"cmdMsngr.dataCommand(\"requestBody\",formValue);","onCancelCode":"cmdMsngr.dataCommand(\"requestBody\",apogeeutil.INVALID_VALUE);","allowInputExpressions":true,"viewState":{"childDisplayState":{"views":{"Form":{"isViewActive":true},"Input":{"isViewActive":false},"On Save":{"height":7000,"isViewActive":true},"On Cancel":{"height":7000,"isViewActive":true}}}}},"requestBody":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":false},"Private":{"isViewActive":false}}}}},"inputValid":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":true,"height":7000},"Private":{"isViewActive":false}}}}},"params":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":true,"height":7000},"Private":{"isViewActive":false}}}}},"insertModuleVersionQuery":{"type":"apogeeapp.SqliteQueryCell","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Result":{"height":280,"isViewActive":true},"Input":{"isViewActive":true}}}}},"_endpointDescriptor_addModuleVersion":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":false},"Private":{"isViewActive":false}}}}}},"viewState":{"childDisplayState":null,"treeState":1,"tabOpened":true}},"getModules":{"type":"apogeeapp.PageComponent","data":{"doc":{"type":"doc","content":[{"type":"heading1","content":[{"type":"text","text":"Get Modules"}]},{"type":"paragraph","content":[{"type":"text","text":"This endpoint returns the list of module info, given the type of modules to be downloaded."}]},{"type":"heading2","content":[{"type":"text","text":"Test Input"}]},{"type":"apogeeComponent","attrs":{"name":"inputForm","id":0,"state":""}},{"type":"paragraph","content":[{"type":"text","text":"TO DO - get the user name from the session!"}]},{"type":"heading2","content":[{"type":"text","text":"Descriptor"}]},{"type":"apogeeComponent","attrs":{"name":"_endpointDescriptor_addModuleVersion","id":0,"state":""}},{"type":"heading2","content":[{"type":"text","text":"Request"}]},{"type":"apogeeComponent","attrs":{"name":"requestParams","id":0,"state":""}},{"type":"heading2","content":[{"type":"text","text":"Response"}]},{"type":"apogeeComponent","attrs":{"name":"responseBody","id":0,"state":""}},{"type":"heading2","content":[{"type":"text","text":"Implementation"}]},{"type":"paragraph","content":[{"type":"text","text":"This table validates the input data. if it is not valid it throws an exception. If it is valid it just returns true."}]},{"type":"apogeeComponent","attrs":{"name":"inputValid","id":0,"state":""}},{"type":"paragraph","content":[{"type":"text","text":"We select the query based on module type."}]},{"type":"apogeeComponent","attrs":{"name":"ES_SQL","id":0,"state":""}},{"type":"apogeeComponent","attrs":{"name":"NPM_SQL","id":0,"state":""}},{"type":"apogeeComponent","attrs":{"name":"sql","id":0,"state":""}},{"type":"paragraph","content":[{"type":"text","text":"Here is the result from the database."}]},{"type":"apogeeComponent","attrs":{"name":"getModulesQuery","id":0,"state":""}},{"type":"paragraph","content":[{"type":"text","text":"Here we collect the module data from the above query."}]},{"type":"apogeeComponent","attrs":{"name":"moduleMap","id":0,"state":""}},{"type":"paragraph","content":[{"type":"text","text":"Here we format the module data for out reponse."}]},{"type":"apogeeComponent","attrs":{"name":"moduleData","id":0,"state":""}}]}},"children":{"inputForm":{"type":"apogeeapp.DesignerActionFormCell","onSubmitCode":"cmdMsngr.dataCommand(\"requestParams\",formValue);","onCancelCode":"cmdMsngr.dataCommand(\"requestParams\",apogeeutil.INVALID_VALUE);","allowInputExpressions":true,"viewState":{"childDisplayState":{"views":{"Form":{"isViewActive":true},"Input":{"isViewActive":false},"On Save":{"height":7000,"isViewActive":true},"On Cancel":{"height":7000,"isViewActive":true}}}}},"inputValid":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":true,"height":7000},"Private":{"isViewActive":false}}}}},"requestParams":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":false},"Private":{"isViewActive":false}}}}},"responseBody":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"isViewActive":true,"height":7000},"Formula":{"isViewActive":true,"height":7000},"Private":{"isViewActive":false}}}}},"sql":{"type":"apogeeapp.JsonCell","dataView":"Text Data","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":true,"height":7000},"Private":{"isViewActive":false}}}}},"NPM_SQL":{"type":"apogeeapp.JsonCell","dataView":"Text Data","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":false},"Private":{"isViewActive":false}}}}},"ES_SQL":{"type":"apogeeapp.JsonCell","dataView":"Text Data","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":false},"Private":{"isViewActive":false}}}}},"getModulesQuery":{"type":"apogeeapp.SqliteQueryCell","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Result":{"height":280,"isViewActive":true},"Input":{"isViewActive":true}}}}},"moduleMap":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":false,"height":7000},"Private":{"isViewActive":false}}}}},"moduleData":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"isViewActive":true,"height":280},"Formula":{"height":7000,"isViewActive":false},"Private":{"isViewActive":false}}}}},"_endpointDescriptor_addModuleVersion":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":false},"Private":{"isViewActive":false}}}}}},"viewState":{"childDisplayState":null,"treeState":1,"tabOpened":true}},"uploadModuleFile":{"type":"apogeeapp.PageComponent","data":{"doc":{"type":"doc","content":[{"type":"heading1","content":[{"type":"text","text":"Upload Module File"}]},{"type":"heading2","content":[{"type":"text","text":"Test Input"}]},{"type":"apogeeComponent","attrs":{"name":"inputForm","id":0,"state":""}},{"type":"paragraph","content":[{"type":"text","text":"TO DO - update submit and cancel to work with the two inputs."}]},{"type":"heading2","content":[{"type":"text","text":"Descriptor"}]},{"type":"apogeeComponent","attrs":{"name":"_endpointDescriptor_uploadModuleFile","id":0,"state":""}},{"type":"heading2","content":[{"type":"text","text":"Request"}]},{"type":"apogeeComponent","attrs":{"name":"requestBody","id":0,"state":""}},{"type":"paragraph"},{"type":"apogeeComponent","attrs":{"name":"pathParams","id":0,"state":""}},{"type":"heading2","content":[{"type":"text","text":"Response"}]},{"type":"paragraph","content":[{"type":"text","text":"No response body. An error will happen is tables have an error. "}]},{"type":"heading2","content":[{"type":"text","text":"Implementation"}]},{"type":"paragraph","content":[{"type":"text","text":"This table validates the input data. if it is not valid it throws an exception. If it is valid it just returns true."}]},{"type":"apogeeComponent","attrs":{"name":"inputValid","id":0,"state":""}},{"type":"paragraph","content":[{"type":"text","text":"Steps"}]},{"type":"bulletList","content":[{"type":"listItem","content":[{"type":"text","text":"load the matching module and module version entries (use an outer join to always load module even if module version does not exist)"}]},{"type":"listItem","content":[{"type":"text","text":"if the module version exists, require: status is pending for module version, otherwise error"}]},{"type":"listItem","content":[{"type":"text","text":"update the module version to include the proper url."}]},{"type":"listItem","content":[{"type":"text","text":"save the file. (LATER - fix error handling in case db update succeeds but file save fails!!!)"}]}]},{"type":"apogeeComponent","attrs":{"name":"loadQueryParams","id":0,"state":""}},{"type":"heading3","content":[{"type":"text","text":"Load Matching Module and Module Version Data"}]},{"type":"paragraph","content":[{"type":"text","text":"Here we load the module and module version data. We require module version be present, though we only allow updating it if the status is \"pending\""}]},{"type":"apogeeComponent","attrs":{"name":"loadModuleQuery","id":0,"state":""}},{"type":"heading3","content":[{"type":"text","text":"Update the Module Version Entry"}]},{"type":"paragraph","content":[{"type":"text","text":"Here will update he module version to hold the url, if applicable. We will provide the test here to see if he insert is allowed."}]},{"type":"apogeeComponent","attrs":{"name":"filePath","id":0,"state":""}},{"type":"apogeeComponent","attrs":{"name":"updateQuerySql","id":0,"state":""}},{"type":"apogeeComponent","attrs":{"name":"updateQueryParams","id":0,"state":""}},{"type":"apogeeComponent","attrs":{"name":"updateModuleVersionQuery","id":0,"state":""}},{"type":"heading3","content":[{"type":"text","text":"Save File"}]},{"type":"paragraph","content":[{"type":"text","text":"if we successfull update the database for the new URL, we will save the file."}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"highlight","attrs":{"color":"yellow"}}],"text":"NOTE - we need error handling in case the file save fails after we added the DB entry for it."}]},{"type":"apogeeComponent","attrs":{"name":"fullFilePath","id":0,"state":""}},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"highlight","attrs":{"color":"yellow"}}],"text":"we need a return value - gives undefined on success below."}]},{"type":"apogeeComponent","attrs":{"name":"saveFile","id":0,"state":""}},{"type":"heading2"},{"type":"paragraph"}]}},"children":{"inputForm":{"type":"apogeeapp.DesignerActionFormCell","onSubmitCode":"let metadata = {};\nObject.assign(metadata,formValue);\ndelete metadata.file;\n\nlet file = formValue.file;\n\ncmdMsngr.compoundDataCommand([[\"requestBody\",file],[\"pathParams\",metadata]]);","onCancelCode":"cmdMsngr.compoundDataCommand([[\"requestBody\",apogeeutil.INVALID_VALUE],[\"pathParams\",apogeeutil.INVALID_VALUE]]);","allowInputExpressions":true,"viewState":{"childDisplayState":{"views":{"Form":{"isViewActive":true},"Input":{"isViewActive":false},"On Save":{"height":7000,"isViewActive":false},"On Cancel":{"height":7000,"isViewActive":false}}}}},"requestBody":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":false},"Private":{"isViewActive":false}}}}},"inputValid":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":false},"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":true,"height":7000},"Private":{"isViewActive":false}}}}},"saveFile":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"isViewActive":true,"height":280},"Formula":{"height":7000,"isViewActive":true},"Private":{"isViewActive":false}}}}},"loadModuleQuery":{"type":"apogeeapp.SqliteQueryCell","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Result":{"isViewActive":true,"height":280},"Input":{"isViewActive":true}}}}},"updateModuleVersionQuery":{"type":"apogeeapp.SqliteQueryCell","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Result":{"isViewActive":true,"height":280},"Input":{"isViewActive":true}}}}},"updateQueryParams":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":true,"height":7000},"Private":{"isViewActive":false}}}}},"pathParams":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":false,"height":7000},"Private":{"isViewActive":false}}}}},"loadQueryParams":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":true,"height":7000},"Private":{"isViewActive":false}}}}},"updateQuerySql":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":true,"height":7000},"Private":{"isViewActive":false}}}}},"fullFilePath":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":true,"height":7000},"Private":{"isViewActive":false}}}}},"filePath":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":true,"height":7000},"Private":{"isViewActive":false}}}}},"_endpointDescriptor_uploadModuleFile":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":false},"Private":{"isViewActive":false}}}}}},"viewState":{"childDisplayState":null,"treeState":1,"tabOpened":true,"tabShowing":true}},"FILE_URL_PREFIX":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":false},"Private":{"isViewActive":false}}}}},"contentFolderForm":{"type":"apogeeapp.FullDataFormCell","layoutCode":"let onSubmit = () => {\n    var {dialog} = require('electron').remote;\n\n    let pathPromise = dialog.showOpenDialog({properties: ['openDirectory']})\n        .then( fileOpenResult => {\n            if(fileOpenResult.canceled) {\n                //canceled - no action\n                return;\n            }\n        \telse if(fileOpenResult.filePaths.length === 1) {\n        \t    commandMessenger.dataCommand(\"moduleFolderForm.value\",fileOpenResult.filePaths[0]);\n        \t}\n        \telse if(fileOpenResult.filePaths.length > 1) {\n        \t    apogeeUserAlert(\"Multiple file selection not supported!\");\n        \t}\n        \telse {\n        \t    //canceled - no action\n        \t\tapogeeUserAlert(\"Unknown error: no path selected\");\n        \t}\n        })\n        .catch(err => {\n        \tapogeeUserAlert(\"Error getting DB path: \" + err.toString());\n        });\n}\n\nreturn [\n    {\n        type: \"submit\",\n        onSubmit: onSubmit,\n        submitLabel: \"Select Folder\"\n    }    \n]","validatorCode":"return true","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"form":{"isViewActive":true},"layout":{"height":7000,"isViewActive":false},"validator":{"isViewActive":false,"height":7000},"input":{"isViewActive":false,"height":7000},"inputPrivate":{"isViewActive":false,"height":7000},"value":{"isViewActive":true,"height":280}}}}},"_serviceDescriptor_":{"type":"apogeeapp.JsonCell","dataView":"Colorized","viewState":{"childDisplayState":{"views":{"Info":{"isViewActive":true},"Data":{"isViewActive":true,"height":280},"Formula":{"isViewActive":false},"Private":{"isViewActive":false}}}}}},"viewState":{"treeState":1,"tabOpened":true}},"Design":{"type":"apogeeapp.PageComponent","data":{"doc":{"type":"doc","content":[{"type":"heading1","content":[{"type":"text","text":"Module Repository Design"}]},{"type":"heading2","content":[{"type":"text","text":"Notes"}]},{"type":"heading3","content":[{"type":"text","text":"Hosting"}]},{"type":"bulletList","content":[{"type":"listItem","content":[{"type":"text","text":"I need to get a permanent URL for the repository. I don't want to change the links - modules.apogeejs.com?"}]},{"type":"listItem","content":[{"type":"text","text":"For starters, I have no real server, even if this is the code. My plan is to run this temporarily. I also want the service to run on static files."}]}]},{"type":"paragraph","content":[{"type":"text","text":"Static file sources:"}]},{"type":"bulletList","content":[{"type":"listItem","content":[{"type":"text","text":"Github"}]},{"type":"listItem","content":[{"type":"text","text":"netlify"}]},{"type":"listItem","content":[{"type":"text","text":"azure or other real host"}]}]},{"type":"paragraph","content":[{"type":"text","text":"I'll run off off github only for initial testing. I will switch to netlify so other people can use it with the final URL. Before this goes public I will make a real service that processing inputs."}]},{"type":"paragraph","content":[{"type":"text","text":"Static Design:"}]},{"type":"bulletList","content":[{"type":"listItem","content":[{"type":"text","text":"For now, I want to allow two distinct requests - npm and es modules."}]},{"type":"listItem","content":[{"type":"text","text":"Later, I will also want to alter the response based on the version of the app requesting. "},{"type":"text","marks":[{"type":"highlight","attrs":{"color":"yellow"}}],"text":"FOR NOW I WILL IGNORE THAT"}]}]},{"type":"paragraph","content":[{"type":"text","text":"Server Design for Static Site Generation"}]},{"type":"bulletList","content":[{"type":"listItem","content":[{"type":"text","text":"The server will populate the file system and the sqlite database"}]},{"type":"listItem","content":[{"type":"text","text":"I will have a process to call the server and generate the request files. Probably an apogee workspace"}]}]},{"type":"paragraph","content":[{"type":"text","text":"An issue for transitioning the server is that the module request file needs to list the url. And ideally this would be a constant. But we can't do that with our server migration plan. Options for hadling the URL:"}]},{"type":"bulletList","content":[{"type":"listItem","content":[{"type":"text","marks":[{"type":"highlight","attrs":{"color":"#a0a0a0"}}],"text":"I can define a relative url in the file, and the program can use that. BUT I really do want a single real url. "}]},{"type":"listItem","content":[{"type":"text","text":"In the server, set it to a constant url, whatever will be the place from which it is accessed. So initially I would set it to github. And you couldn't access the file from the local location. "}]},{"type":"listItem","content":[{"type":"text","text":"I could make a conversion of the host in the workspace that generates the request tile."}]},{"type":"listItem","content":[{"type":"text","text":"I could pass a dummy param in that tells what the hosting server is for the files"}]}]},{"type":"paragraph","content":[{"type":"text","text":"I'll do all three that are not grayed out.  "}]},{"type":"heading2","content":[{"type":"text","text":"Actions"}]},{"type":"paragraph","content":[{"type":"text","text":"We will start with an initial implementation where the grayed out endpoints are not implemented. Some features of the initial implementation:"}]},{"type":"bulletList","content":[{"type":"listItem","content":[{"type":"text","text":"Users exist but there is no authentication or authorization."}]},{"type":"listItem","content":[{"type":"text","text":"We will add a user field when creating a module so we can fill in that database field."}]}]},{"type":"heading3","content":[{"type":"text","text":"User management"}]},{"type":"bulletList","content":[{"type":"listItem","content":[{"type":"text","text":"add user"}]},{"type":"listItem","content":[{"type":"text","marks":[{"type":"highlight","attrs":{"color":"#a0a0a0"}}],"text":"update user - email, password"}]},{"type":"listItem","content":[{"type":"text","marks":[{"type":"highlight","attrs":{"color":"#a0a0a0"}}],"text":"remove user"}]},{"type":"listItem","content":[{"type":"text","marks":[{"type":"highlight","attrs":{"color":"#a0a0a0"}}],"text":"login"}]},{"type":"listItem","content":[{"type":"text","marks":[{"type":"highlight","attrs":{"color":"#a0a0a0"}}],"text":"logout"}]},{"type":"listItem","content":[{"type":"text","marks":[{"type":"highlight","attrs":{"color":"#a0a0a0"}}],"text":"change password"}]},{"type":"listItem","content":[{"type":"text","marks":[{"type":"highlight","attrs":{"color":"#a0a0a0"}}],"text":"reset password"}]}]},{"type":"heading4","content":[{"type":"text","text":"Validation - get a key to enable certain actions (LATER)"}]},{"type":"bulletList","content":[{"type":"listItem","content":[{"type":"text","marks":[{"type":"highlight","attrs":{"color":"#a0a0a0"}}],"text":"request remove user"}]},{"type":"listItem","content":[{"type":"text","marks":[{"type":"highlight","attrs":{"color":"#a0a0a0"}}],"text":"request change password"}]},{"type":"listItem","content":[{"type":"text","marks":[{"type":"highlight","attrs":{"color":"#a0a0a0"}}],"text":"request delete module"}]},{"type":"listItem","content":[{"type":"text","marks":[{"type":"highlight","attrs":{"color":"#a0a0a0"}}],"text":"request delete module version"}]}]},{"type":"heading3","content":[{"type":"text","text":"User Modules"}]},{"type":"bulletList","content":[{"type":"listItem","content":[{"type":"text","text":"add module"}]},{"type":"listItem","content":[{"type":"text","text":"update module"}]},{"type":"listItem","content":[{"type":"text","text":"update module status"}]},{"type":"listItem","content":[{"type":"text","marks":[{"type":"highlight","attrs":{"color":"#a0a0a0"}}],"text":"delete module"}]},{"type":"listItem","content":[{"type":"text","text":"add module version"}]},{"type":"listItem","content":[{"type":"text","text":"upload module file (set or replace)"}]},{"type":"listItem","content":[{"type":"text","marks":[{"type":"highlight","attrs":{"color":"#a0a0a0"}}],"text":"delete module file"}]},{"type":"listItem","content":[{"type":"text","text":"update module version (npm name for one)"}]},{"type":"listItem","content":[{"type":"text","text":"update module version status"}]}]},{"type":"heading3","content":[{"type":"text","text":"All Modules"}]},{"type":"bulletList","content":[{"type":"listItem","content":[{"type":"text","text":"get modules"}]},{"type":"listItem","content":[{"type":"text","marks":[{"type":"highlight","attrs":{"color":"#a0a0a0"}}],"text":"get module info"}]}]},{"type":"heading2","content":[{"type":"text","text":"Schema"}]},{"type":"heading3","content":[{"type":"text","text":"User"}]},{"type":"bulletList","content":[{"type":"listItem","content":[{"type":"text","text":"user_name - (foreign key) text"}]},{"type":"listItem","content":[{"type":"text","text":"email - text"}]},{"type":"listItem","content":[{"type":"text","text":"password_hash - text"}]},{"type":"listItem","content":[{"type":"text","text":"status - text"}]}]},{"type":"paragraph","content":[{"type":"text","text":"status:"}]},{"type":"bulletList","content":[{"type":"listItem","content":[{"type":"text","text":"active - Normal user"}]},{"type":"listItem","content":[{"type":"text","text":"deleted (future) - For a deleted user. The database entry is kept so the name is not reused."}]}]},{"type":"heading3","content":[{"type":"text","text":"Module"}]},{"type":"bulletList","content":[{"type":"listItem","content":[{"type":"text","text":"module_name - text"}]},{"type":"listItem","content":[{"type":"text","text":"user_name (foreign key) text"}]},{"type":"listItem","content":[{"type":"text","text":"display_name - text"}]},{"type":"listItem","content":[{"type":"text","text":"short_desc - text"}]},{"type":"listItem","content":[{"type":"text","text":"status - text"}]}]},{"type":"paragraph","content":[{"type":"text","text":"status:"}]},{"type":"bulletList","content":[{"type":"listItem","content":[{"type":"text","text":"pending - For upload and testing. The data is only accessible by owner at this point. All fields can be updated. (Future - after a certain amount of time this will automatically be changed to active so people don't use it as \"private\")"}]},{"type":"listItem","content":[{"type":"text","text":"prerelease (future) - This is like "},{"type":"text","marks":[{"type":"italic"}],"text":"active"},{"type":"text","text":" except this is not made as the current version of the module. TBD how to handle this in "},{"type":"text","marks":[{"type":"italic"}],"text":"get modules"},{"type":"text","text":"."}]},{"type":"listItem","content":[{"type":"text","text":"active - This means the module is publicly available. At this point, certain fields are not updatable."}]},{"type":"listItem","content":[{"type":"text","text":"deprecated (future) - This is to flag the module as deprecated. TBD on behaviour"}]},{"type":"listItem","content":[{"type":"text","text":"deleted (future) - This is to mark the module as deleted. The database entry is kept so it is not reused."}]}]},{"type":"heading3","content":[{"type":"text","text":"Module Version"}]},{"type":"bulletList","content":[{"type":"listItem","content":[{"type":"text","text":"module_name (primary key 1)(foreign key)"}]},{"type":"listItem","content":[{"type":"text","text":"module_version - (primary key 2) text"}]},{"type":"listItem","content":[{"type":"text","text":"min_app_major_version (for now unused) - int"}]},{"type":"listItem","content":[{"type":"text","text":"min_app_minor_version (for now unused) - int"}]},{"type":"listItem","content":[{"type":"text","text":"max_app_major_version (for now unused) - int"}]},{"type":"listItem","content":[{"type":"text","text":"es_url - text"}]},{"type":"listItem","content":[{"type":"text","text":"npm_name (should match module name, null if not in npm) - text"}]},{"type":"listItem","content":[{"type":"text","text":"npm_url (if a tgz file is available away from npm) text"}]},{"type":"listItem","content":[{"type":"text","text":"es_workspaces (json/text) - text"}]},{"type":"listItem","content":[{"type":"text","text":"npm_workspaces (json/text) - text"}]},{"type":"listItem","content":[{"type":"text","text":"web_link - text"}]},{"type":"listItem","content":[{"type":"text","text":"status (once version is deleted it can not be reused) - TBD"}]}]},{"type":"paragraph","content":[{"type":"text","text":"status - same as for module."}]}]}},"viewState":{"childDisplayState":null,"tabOpened":true}},"viewState":{"treeState":1}}},"viewState":{"treeState":1}}